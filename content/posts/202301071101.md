---
title: ğŸ“ä½ç½®ã«SetValueã™ã‚‹é–¢æ•°
date: 2023-01-07
tags:
  - script
  - program
  - 
---

- up: ğŸ“[Script]({{<ref "posts/script.md">}})

ä½ç½®ã«SetValueã™ã‚‹ã®ã¯ãªã‹ãªã‹é¢å€’ãã•ã„ã€‚æ¬¡å…ƒåˆ†è§£ã§æ¡ä»¶åˆ†å²ãŒå¿…è¦ã ã£ãŸã‚Šã€‚ãªã®ã§é–¢æ•°ã‚’ä½œã£ãŸã€‚

```javascript
/**
 * ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹é–¢æ•° ãƒã‚¸ã‚·ãƒ§ãƒ³ã«ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ãŒã‚ã‚Œã°setValueAtTimeã‚’ä½¿ã£ã¦ç¾åœ¨ã®æ™‚é–“ã«ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’è¿½åŠ ã™ã‚‹
 * @param {*} layer ãƒ¬ã‚¤ãƒ¤ãƒ¼
 * @param {*} XYarray é…åˆ—[x, y, z]
 */
function setPosition(layer, XYZarray) {
  try {
    var comp = app.project.activeItem;
    var x = XYZarray[0]
    var y = XYZarray[1]
    var z = XYZarray[2]
    var position = layer.property('ADBE Transform Group').property('ADBE Position')
    if (!position.dimensionsSeparated) {
      // æ¬¡å…ƒåˆ†å‰²ã•ã‚Œã¦ã„ãªã„å ´åˆ
      var numKey = position.numKeys
      if (numKey == 0) {
        position.setValue([x, y, z])
      } else {
        position.setValueAtTime(comp.time, [x, y, z])
      }
    } else {
      // æ¬¡å…ƒåˆ†å‰²ã•ã‚Œã¦ã„ã‚‹å ´åˆ
      var positionX = layer.property('ADBE Transform Group').property('ADBE Position_0')
      var positionY = layer.property('ADBE Transform Group').property('ADBE Position_1')
      var positionZ = layer.property('ADBE Transform Group').property('ADBE Position_2')
      var numKeyX = positionX.numKeys
      var numKeyY = positionY.numKeys
      var numKeyZ = positionZ.numKeys
      if (numKeyX + numKeyY + numKeyZ == 0) {
        layer.property("ADBE Transform Group").property("ADBE Position_0").setValue(x)
        layer.property("ADBE Transform Group").property("ADBE Position_1").setValue(y)
        if (layer.threeDLayer) {
          layer.property("ADBE Transform Group").property("ADBE Position_2").setValue(z)
        }
      } else {
        layer.property("ADBE Transform Group").property("ADBE Position_0").setValueAtTime(comp.time, x)
        layer.property("ADBE Transform Group").property("ADBE Position_1").setValueAtTime(comp.time, y)
        if (layer.threeDLayer) {
          layer.property("ADBE Transform Group").property("ADBE Position_2").setValueAtTime(comp.time, z)
        }
      }
    }
  } catch (e) {
    alert(e.message + e.line)
  }
}
```